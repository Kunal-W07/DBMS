-- Creating the Customer Table
CREATE TABLE Customer (
    CustID INT PRIMARY KEY,
    Name VARCHAR(50),
    Cust_Address VARCHAR(100),
    Phone_no VARCHAR(15),
    Email_ID VARCHAR(50),
    Age INT
);

-- Inserting Data into Customer Table
INSERT INTO Customer (CustID, Name, Cust_Address, Phone_no, Email_ID, Age)
VALUES 
(1, 'John Doe', '123 Main St, Pune', '9876543210', 'johexa', 30),
(2, 'Alice Smith', '456 Park Rd, Mumbai', '9123456789', 'alice.itm', 25),
(3, 'Alex Green', '789 Maple Ave, Pune', '9234567890', 'alex.greeom', 28);

-- Creating the Branch Table
CREATE TABLE Branch (
    BranchID INT PRIMARY KEY,
    Branch_Name VARCHAR(50),
    Address VARCHAR(100)
);

-- Inserting Data into Branch Table
INSERT INTO Branch (BranchID, Branch_Name, Address)
VALUES 
(1, 'Main Branch', '123 Pune St, Pune'),
(2, 'Secondary Branch', '456 Mumbai St, Mumbai');

-- Creating the Account Table
CREATE TABLE Account (
    Account_no INT PRIMARY KEY,
    BranchID INT,
    CustID INT,
    date_open DATE,
    Account_type VARCHAR(50),
    Balance DECIMAL(10, 2),
    FOREIGN KEY (BranchID) REFERENCES Branch(BranchID),
    FOREIGN KEY (CustID) REFERENCES Customer(CustID)
);

-- Inserting Data into Account Table
INSERT INTO Account (Account_no, BranchID, CustID, date_open, Account_type, Balance)
VALUES 
(101, 1, 1, '2022-01-15', 'Saving Account', 55000),
(102, 2, 2, '2023-04-20', 'Checking Account', 10000),
(103, 1, 3, '2021-10-10', 'Saving Account', 20000);


-- 1. Modify the size of column “Email_Address” to 20 in Customer table.

-- alter table Customer Modify column Email_ID varchar(20);
ALTER TABLE Customer
MODIFY COLUMN Email_ID VARCHAR(20);

select * from Customer;
show columns from Customer;

-- 2. Change the Column Email_ID to NOT NULL in the Customer Table

alter table Customer Modify column Email_ID varchar(20) not null;
show columns from Customer;

-- 3. Display the total customers with the balance >50, 000 Rs.
-- select * from Customer c
-- join Account a on c.

-- 4 Display the total customers with the balance >50, 000 Rs.
SELECT COUNT(*)
FROM Customer c
JOIN Account a ON c.CustID = a.CustID
WHERE a.Balance > 50000;

-- 5. Display Average Balance for Account Type "Saving Account"

SELECT AVG(a.Balance) 
FROM Account a
WHERE a.Account_type = 'Saving Account';













